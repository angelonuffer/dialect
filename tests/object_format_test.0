dialect = ../code/0
unitest = unitest.0

test_object_sequence = dialect.analyze({
  input: "abc"
  grammar: {
    type: "sequence"
    parts: [
      { name: "first" grammar: { type: "symbol" text: "a" } }
      { name: "second" grammar: { type: "symbol" text: "b" } }
      { name: "third" grammar: { type: "symbol" text: "c" } }
    ]
    format: "object"
  }
})

test_list_sequence = dialect.analyze({
  input: "xyz"
  grammar: {
    type: "sequence"
    parts: [
      { type: "symbol" text: "x" }
      { type: "symbol" text: "y" }
      { type: "symbol" text: "z" }
    ]
    format: "list"
  }
})

test_generate_object = dialect.generate({
  value: {
    first: "a"
    second: "b"
    third: "c"
  }
  grammar: {
    type: "sequence"
    parts: [
      { name: "first" grammar: { type: "symbol" text: "a" } }
      { name: "second" grammar: { type: "symbol" text: "b" } }
      { name: "third" grammar: { type: "symbol" text: "c" } }
    ]
    format: "object"
  }
})

unitest.describe({
  name: "Object and List Format Tests"
  tests: [
    unitest.describe({
      name: "Object Sequence"
      tests: [
        unitest.equals([ test_object_sequence.success 1 ])
        unitest.equals([ test_object_sequence.value.first "a" ])
        unitest.equals([ test_object_sequence.value.second "b" ])
        unitest.equals([ test_object_sequence.value.third "c" ])
      ]
    })
    unitest.describe({
      name: "List Sequence"
      tests: [
        unitest.equals([ test_list_sequence.success 1 ])
        unitest.lists_equal([ test_list_sequence.value [ "x" "y" "z" ] ])
      ]
    })
    unitest.describe({
      name: "Generate Object"
      tests: [
        unitest.equals([ test_generate_object.success 1 ])
        unitest.equals([ test_generate_object.output "abc" ])
      ]
    })
  ]
})
