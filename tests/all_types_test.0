dialect = ../code/0
unitest = unitest.0

test_range = dialect.analyze({
  input: "c"
  grammar: {
    type: "range"
    from: "a"
    to: "z"
  }
})

test_sequence = dialect.analyze({
  input: "abc"
  grammar: {
    type: "sequence"
    parts: [
      { type: "symbol" text: "a" }
      { type: "symbol" text: "b" }
      { type: "symbol" text: "c" }
    ]
    format: "text"
  }
})

test_alternative = dialect.analyze({
  input: "hello"
  grammar: {
    type: "alternative"
    options: [
      { type: "symbol" text: "world" }
      { type: "symbol" text: "hello" }
    ]
  }
})

test_optional = dialect.analyze({
  input: ""
  grammar: {
    type: "optional"
    grammar: { type: "symbol" text: "x" }
  }
})

test_repetition = dialect.analyze({
  input: "aaa"
  grammar: {
    type: "repetition"
    grammar: { type: "symbol" text: "a" }
    format: "text"
    minimum: 1
    maximum: 5
  }
})

test_generate_range = dialect.generate({
  value: "m"
  grammar: {
    type: "range"
    from: "a"
    to: "z"
  }
})

unitest.describe({
  name: "All Grammar Types Tests"
  tests: [
    unitest.describe({
      name: "Range"
      tests: [
        unitest.equals([ test_range.success 1 ])
        unitest.equals([ test_range.value "c" ])
      ]
    })
    unitest.describe({
      name: "Sequence"
      tests: [
        unitest.equals([ test_sequence.success 1 ])
        unitest.equals([ test_sequence.value "abc" ])
      ]
    })
    unitest.describe({
      name: "Alternative"
      tests: [
        unitest.equals([ test_alternative.success 1 ])
        unitest.equals([ test_alternative.value "hello" ])
      ]
    })
    unitest.describe({
      name: "Optional"
      tests: [
        unitest.equals([ test_optional.success 1 ])
        unitest.equals([ test_optional.value "" ])
      ]
    })
    unitest.describe({
      name: "Repetition"
      tests: [
        unitest.equals([ test_repetition.success 1 ])
        unitest.equals([ test_repetition.value "aaa" ])
      ]
    })
    unitest.describe({
      name: "Generate Range"
      tests: [
        unitest.equals([ test_generate_range.success 1 ])
        unitest.equals([ test_generate_range.output "m" ])
      ]
    })
  ]
})
